<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body {
      margin:0;
      font-family:sans-serif;
      background:#2b2d31;
      color:white;
      display:flex;
      height:100vh;
    }
    .sidebar {
      width:250px;
      background:#1e1f22;
      padding:10px;
    }
    .main {
      flex:1;
      display:flex;
      flex-direction:column;
    }
    .messages {
      flex:1;
      padding:10px;
      overflow-y:auto;
    }
    .input {
      display:flex;
      padding:10px;
      background:#383a40;
    }
    input {
      flex:1;
      padding:10px;
      margin-right:10px;
      border:none;
      border-radius:5px;
    }
    button {
      padding:10px;
      border:none;
      border-radius:5px;
      cursor:pointer;
    }
    .auth {
      position:absolute;
      top:50%;
      left:50%;
      transform:translate(-50%, -50%);
      display:flex;
      flex-direction:column;
      width:250px;
    }
  </style>
</head>
<body>

<div id="auth" class="auth">
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button onclick="signUp()">Sign Up</button>
  <button onclick="login()">Login</button>
</div>

<div class="sidebar" id="sidebar" style="display:none;">
  <h3>Conversations</h3>
  <div id="conversationList"></div>
  <button onclick="logout()">Logout</button>
</div>

<div class="main" id="main" style="display:none;">
  <div class="messages" id="messages"></div>
  <div class="input">
    <input id="messageInput" placeholder="Type a message">
    <button onclick="sendMessage()">Send</button>
  </div>
</div>

<script>
const supabase = window.supabase.createClient(
  "PASTE_YOUR_PROJECT_URL",
  "PASTE_YOUR_ANON_KEY"
)

let currentUser = null

async function signUp() {
  const email = document.getElementById("email").value
  const password = document.getElementById("password").value
  await supabase.auth.signUp({ email, password })
  alert("Account created. Now log in.")
}

async function login() {
  const email = document.getElementById("email").value
  const password = document.getElementById("password").value
  const { data, error } = await supabase.auth.signInWithPassword({ email, password })

  if (error) {
    alert(error.message)
    return
  }

  currentUser = data.user
  loadApp()
}

async function logout() {
  await supabase.auth.signOut()
  location.reload()
}

function loadApp() {
  document.getElementById("auth").style.display = "none"
  document.getElementById("sidebar").style.display = "block"
  document.getElementById("main").style.display = "flex"
}

supabase.auth.getUser().then(({ data }) => {
  if (data.user) {
    currentUser = data.user
    loadApp()
  }
})
</script>

</body>
</html>
